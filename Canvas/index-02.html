<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>02</title>
  </head>
  <style>
    canvas {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: #333;
    }
  </style>
  <body>
    <canvas></canvas>
  </body>
  <script>
    function toggleFullScreen() {
      if (!document.fullscreenElement) {
        document.documentElement.requestFullscreen()
      } else {
        if (document.exitFullscreen) {
          document.exitFullscreen()
        }
      }
    }
    document.addEventListener(
      'keydown',
      function (e) {
        if (e.keyCode == 13) {
          toggleFullScreen()
        }
      },
      false
    )

    const canvas = document.querySelector('canvas')
    const ctx = canvas.getContext('2d')
    function init() {
      canvas.width = window.innerWidth * devicePixelRatio
      canvas.height = window.innerHeight * devicePixelRatio
    }
    init()
    const fontSize = 20 * devicePixelRatio
    ctx.font = `${fontSize}px "Roboto Mono"`
    const columns = Math.floor(canvas.width / fontSize)
    const charIndexArr = new Array(columns).fill(0)

    function draw() {
      ctx.fillStyle = 'rgba(0,0,0,0.1)'
      ctx.fillRect(0, 0, canvas.width, canvas.height)
      ctx.fillStyle = '#6be445'
      ctx.textAlign = 'right'
      ctx.textBaseline = 'top'
      for (let index = 0; index < columns; index++) {
        const x = index * fontSize
        const y = charIndexArr[index] * fontSize
        ctx.fillText(getRandomChar(), x, y)
        if (y > canvas.height && Math.random() > 0.99) {
          charIndexArr[index] = 0
        } else {
          charIndexArr[index]++
        }
      }
    }
    draw()
    setInterval(() => {
      draw()
    }, 50)
    function getRandomChar() {
      const str = '01234567890abcdefghijklmnoprstuvwxyz'
      return str[Math.floor(Math.random() * str.length)]
    }
  </script>
</html>
