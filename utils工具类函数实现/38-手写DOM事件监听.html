<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>38-手写DOM事件监听</title>
  </head>
  <body>
    <ul id="ul">
      <li>aaa</li>
      <li>bbb</li>
      <li>ccc</li>
      <li>ddd</li>
    </ul>
  </body>
  <script>
    function addEventListener(el, type, fn, selector) {
      if (typeof el === 'string') {
        el = document.querySelector(el)
      }
      // 如果没有指定 selector 普通的事件绑定
      if (!selector) {
        element.addEventListener(type, fn)
        return
      }
      el.addEventListener(type, function (event) {
        // 得到真正发生事件的目标元素
        const target = event.target
        // 如果与选择器匹配
        if (target.matches(selector)) {
          // 调用处理事件的回调fn, 并指定this为目标元素, 参数为event
          fn.call(target, event)
        }
      })
    }

    addEventListener(
      '#ul',
      'click',
      function (event) {
        console.log(this.innerHTML, event)
      },
      'li'
    )
  </script>
</html>
